
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile within the Swasthya Margdarshan application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity, matches Firebase Auth UID."
        },
        "username": {
          "type": "string",
          "description": "The user's chosen unique username."
        },
        "email": {
          "type": "string",
          "description": "The user's email address, used for login.",
          "format": "email"
        },
        "age": {
          "type": "number",
          "description": "The user's age in years."
        },
        "height": {
          "type": "number",
          "description": "The user's height in centimeters."
        },
        "weight": {
          "type": "number",
          "description": "The user's weight in kilograms."
        },
        "photoURL": {
          "type": "string",
          "description": "URL of the user's profile picture, stored as a data URI.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "username",
        "email",
        "age",
        "height",
        "weight"
      ]
    },
    "Medicine": {
      "title": "Medicine",
      "type": "object",
      "description": "Represents a single medicine in the user's tracking list.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The UID of the user this medicine belongs to."
        },
        "name": {
          "type": "string",
          "description": "The name of the medicine."
        },
        "dosage": {
          "type": "string",
          "description": "Dosage information (e.g., '500 mg', '1 tablet')."
        },
        "frequency": {
          "type": "string",
          "enum": ["Once", "Twice", "Thrice", "Custom"],
          "description": "How often the medicine is taken daily."
        },
        "times": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["Morning", "Afternoon", "Night"]
          },
          "description": "Specific times of day to take the medicine."
        },
        "startDate": {
          "type": "string",
          "format": "date",
          "description": "The start date for taking the medicine."
        },
        "endDate": {
          "type": "string",
          "format": "date",
          "description": "The end date for taking the medicine."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the medicine was added."
        }
      },
      "required": ["userId", "name", "dosage", "frequency", "times", "startDate", "endDate", "createdAt"]
    },
    "MedicineStatus": {
      "title": "Medicine Status",
      "type": "object",
      "description": "Tracks the status of a specific medicine dose on a given day.",
      "properties": {
        "medicineId": {
          "type": "string",
          "description": "The ID of the medicine this status refers to."
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "The specific date this status applies to (YYYY-MM-DD)."
        },
        "status": {
           "type": "object",
           "propertyNames": {
             "pattern": "^(Morning|Afternoon|Night)$"
           },
           "patternProperties": {
             ".*": {
                "type": "string",
                "enum": ["Pending", "Taken", "Missed"]
             }
           }
        }
      },
      "required": ["medicineId", "date", "status"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information in a top-level 'users' collection. The document ID matches the Firebase Auth UID.",
          "subcollections": [
            {
              "path": "medicines/{medicineId}",
              "definition": {
                "entityName": "Medicine",
                "schema": {
                  "$ref": "#/backend/entities/Medicine"
                },
                "description": "A sub-collection to store all medicines for a specific user."
              }
            },
            {
               "path": "medicineStatuses/{statusId}",
               "definition": {
                 "entityName": "MedicineStatus",
                 "schema": {
                    "$ref": "#/backend/entities/MedicineStatus"
                 },
                 "description": "Stores the daily status of each medicine dose for a user. Document ID can be medicineId_YYYY-MM-DD."
               }
            }
          ]
        }
      }
    ],
    "reasoning": "A `medicines` sub-collection under each user document is scalable and ensures data is user-specific. A separate `medicineStatuses` sub-collection is used to track the daily taken/missed status, which avoids bloating the main medicine documents with frequently changing data and simplifies queries for 'today's' medicine statuses."
  }
}
